function [TI, D] = bspline_transform(O_trans, Spacing, I)
    
    [TI,Tx,Ty,Tz]=bspline_transform_3d_single(...
    single(O_trans(:,:,:,1)),...
    single(O_trans(:,:,:,2)),...
    single(O_trans(:,:,:,3)),...
    single(I),...
    single(Spacing(1)),...
    single(Spacing(2)),...
    single(Spacing(3)),...
    0);

    D(:,:,:,1)=Tx; 
    D(:,:,:,2)=Ty; 
    D(:,:,:,3)=Tz;

end

